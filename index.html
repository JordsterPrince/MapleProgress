<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MapleStory Equipment Input</title>
    <!-- Load custom font (optional but thematic) -->
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <!-- Link to external CSS file -->
  <link rel="stylesheet" href="style.css">
  
</head>
<body>

  <h1>MapleStory Equipment Tracker</h1>
  

  <form id="equipForm">
    <table>
      <thead>
        <tr>
          <th>Equipment Slot</th>
          <th>Item Level</th>
          <th>Flame Score</th>
          <th>Potential %</th>
        </tr>
      </thead>
      <tbody id="equipmentTable">
        <!-- Rows will be injected by JS -->
      </tbody>
    </table>

    <button type="submit">Submit All</button>
    <div id="results"></div>
  </form>

  <script>
    const slots = [
      "Ring 1", "Ring 2", "Ring 3", "Ring 4",
      "Pendant 1", "Pendant 2", "Belt", "Hat",
      "Face", "Eye", "Top", "Bottom", "Shoes",
      "Earring", "Shoulder", "Glove", "Cape",
      "Heart", "Pocket" // ðŸ‘ˆ add Pocket at the end
    ];

    const table = document.getElementById("equipmentTable");

    slots.forEach(slot => {
      const isRingOrShoulderOrHeart = slot.startsWith("Ring") || slot === "Shoulder" || slot === "Heart";
      const isPocket = slot === "Pocket";

      const row = document.createElement("tr");

      // Flame Input Cell
      const flameCell = isRingOrShoulderOrHeart
        ? "<em>N/A</em>"
        : `
          <input type="number" name="${slot}_allstat" placeholder="All%" min="0" style="width: 50px;" />
          <input type="number" name="${slot}_attack" placeholder="Atk" min="0" style="width: 50px;" />
          <input type="number" name="${slot}_mainstat" placeholder="Main" min="0" style="width: 50px;" />
          <input type="number" name="${slot}_secondarystat" placeholder="Sec" min="0" style="width: 50px;" />
        `;

      // Potential Cell: skip if Pocket
      const potentialCell = isPocket
        ? "<em>N/A</em>"
        : `<input type="number" name="${slot}_potential" min="0" max="100" />`;

      row.innerHTML = `
        <td>${slot}</td>
        <td><input type="number" name="${slot}_level" min="0" /></td>
        <td>${flameCell}</td>
        <td>${potentialCell}</td>
      `;

      table.appendChild(row);
    });

    document.getElementById("equipForm").addEventListener("submit", async function(e) {
      e.preventDefault();

      const formData = new FormData(e.target);
      const data = {};

      slots.forEach(slot => {
        const itemLevel = Number(formData.get(`${slot}_level`)) || 0;

        const allStat = Number(formData.get(`${slot}_allstat`)) || 0;
        const attack = Number(formData.get(`${slot}_attack`)) || 0;
        const mainStat = Number(formData.get(`${slot}_mainstat`)) || 0;
        const secondaryStat = Number(formData.get(`${slot}_secondarystat`)) || 0;

        const flameScore = (allStat * 12) + (attack * 3) + mainStat + Math.round(secondaryStat / 12);

        const potential = slot === "Pocket"
          ? 0  // No input now, but leave the field in
          : Number(formData.get(`${slot}_potential`)) || 0;
          
        data[slot] = {
          itemLevel,
          flameScore,
          potential
        };
      });

      // âœ… Call your Azure Function URL here
      const response = await fetch("https://mapleprogress-bbckbxg3cvbmfwck.eastus-01.azurewebsites.net/api/calculate", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      const resultHtml = await response.text();
      document.getElementById("results").innerHTML = resultHtml;
    });
  </script>

</body>
</html>
